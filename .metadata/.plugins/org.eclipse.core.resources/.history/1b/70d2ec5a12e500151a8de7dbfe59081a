package com.example.ble_linker;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.ListView;

public class MainActivity extends Activity {

	private List<HashMap<String, Object>> mData;
	private ListView listView;

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_main);

		mData = getData();// 为刚才的变量赋值
		MyAdapter adapter = new MyAdapter(this);// 创建一个适配器

		listView = (ListView) findViewById(R.id.devices_list);// 实例化ListView
		listView.setAdapter(adapter);// 为ListView控件绑定适配器

	}

	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.main, menu);
		return true;
	}

	@Override
	public boolean onOptionsItemSelected(MenuItem item) {
		// Handle action bar item clicks here. The action bar will
		// automatically handle clicks on the Home/Up button, so long
		// as you specify a parent activity in AndroidManifest.xml.
		int id = item.getItemId();
		if (id == R.id.action_settings) {
			return true;
		}
		return super.onOptionsItemSelected(item);
	}

	// 初始化一个List
	private List<HashMap<String, Object>> getData() {
		// 新建一个集合类，用于存放多条数据
		ArrayList<HashMap<String, Object>> list = new ArrayList<HashMap<String, Object>>();
		HashMap<String, Object> map = null;
		for (int i = 1; i <= 3; i++) {
			map = new HashMap<String, Object>();
			map.put("devicename", "aaa");
			list.add(map);
		}
		return list;
	}
	package com.example.ble_linker;

	import java.util.ArrayList;
	import java.util.HashMap;
	import java.util.List;

	import android.content.Context;
	import android.view.LayoutInflater;
	import android.view.View;
	import android.view.ViewGroup;
	import android.widget.BaseAdapter;
	import android.widget.Button;
	import android.widget.TextView;


	/**
	 * 
	 * @author huang pan
	 *自定义适配器
	 */
	public class MyAdapter extends BaseAdapter {

		private LayoutInflater mInflater; //动态布局映射
		
		private List<HashMap<String, Object>> mData;  //动态存储
		
		
		public MyAdapter(Context context) {
			this.mInflater = LayoutInflater.from(context); 
		}

		
		//决定ListView有几行可见
		@Override
		public int getCount() {
			// TODO Auto-generated method stub
			return mData.size();
		}

		@Override
		public Object getItem(int position) {
			// TODO Auto-generated method stub
			return null;
		}

		@Override
		public long getItemId(int position) {
			// TODO Auto-generated method stub
			return 0;
		}

		@Override
		public View getView(final int position, View convertView, ViewGroup parent) {
			// TODO Auto-generated method stub
			ViewHolder holder = null; 
			
			if(null == convertView)	{
			convertView = mInflater.inflate(R.layout.activity_main, null); //根据布局文件实例化view
			
			holder.device_name = (TextView)convertView.findViewById(R.id.device_name); //找到device名字的textview
			
			holder.connect_btn = (Button)convertView.findViewById(R.id.connect_btn);
			convertView.setTag(holder);
					}
			else
				holder = (ViewHolder)convertView.getTag();
				
			holder.device_name.setText(mData.get(position).get("devicename").toString());
			holder.connect_btn.setTag(position);
			
			holder.connect_btn.setOnClickListener(new View.OnClickListener() {
				
				@Override
				public void onClick(View v) {
					// TODO Auto-generated method stub
					showInfo(position);
				} 
				
			});
			
			return convertView;
		}

		public final class ViewHolder{
			public TextView device_name;
			public Button connect_btn;
			
		}
		
		private void showInfo(int position) {
			// TODO Auto-generated method stub
//			AlertDialog show = new AlertDialog.Builder(this)
//			.setTitle("ding")
//			.setMessage("菜名：")
//			.setPositiveButton("确定", new DialogInterface.OnClickListener() {
//				@Override
//				public void onClick(DialogInterface dialog, int which) {
//				}
//			})
//			.show();
			
			//Toast.makeText(this.context, "hasdhah", 100000);
			//Toast.makeText(getApplicationContext(), "默认Toast样式",Toast.LENGTH_SHORT).show();
			
		}
		

		
		
	}

}
